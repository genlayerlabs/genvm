# GenVM
[![Discord](https://dcbadge.vercel.app/api/server/8Jm4v89VAu?compact=true&style=flat)](https://discord.gg/VpfmXEMN66) [![Twitter](https://img.shields.io/twitter/url/https/twitter.com/yeagerai.svg?style=social&label=Follow%20%40GenLayer)](https://x.com/GenLayer)

GenVM is the execution environment for Intelligent Contracts in the GenLayer protocol. It serves as the backbone for processing and managing contract operations within the GenLayer ecosystem.

GenVM's only purpose is to execute Intelligent Contracts, which can have non-deterministic code while maintaining blockchain security and consistency.

## About

It is a monorepo for GenVM, which consists of the following sub-projects:

- [executor](./executor/) core GenVM itself: modified [`wasmtime`](https://wasmtime.dev) which exposes genvm-sdk-wasi implementation and does all the sandboxing work
- [sdk-rust](./sdk-rust/): rust bindings for genvm-sdk-wasi, this library is autogenerated from [witx](./executor/src/wasi/witx/genlayer_sdk.witx)
- [runners](./runners/): various "runners" available for contracts to use
    - software floating point implementation
    - python interpreter with built-in `sdk-rust`
    - python standard library from genlayer
    - ...

##  GenVM for users

For "getting started" documentation please refer to [GenLayer documentation](https://docs.genlayer.com/build-with-genlayer/intelligent-contracts)

For more complex examples you can look into [this](./executor/testdata/cases/py-core) part of test suite


## Building from source

Required tools:
- git
- ruby (3.\*)
- ninja
- rustup (cargo+rustc)

All of them (except for the git for obvious reasons) are provided by default shell in `build-scripts/devenv/flake.nix` (for direnv add `use flake ./build-scripts/devenv`)

Prelude:
- `./tools/ya-build/ya-build config`<br />
  This command scraps and configures all targets (similar to CMake)
- `ninja` is an alternative to `make`, it runs build commands
- Output is located at `build/out` as a "root" (`bin`, `share`)

### Simple
1. `cd $PROJECT_DIR`
2. `git submodule update --init --recursive --depth 1`
3. `source env.sh` (not needed if you used flake)
4. `git third-party update --all`
5. `ya-build config` (for release build pass `--preload build-scripts/ci/release-conf.rb`)
6. `ninja -C build genvm/executor/all`
7. Get `genvm-runners.zip` from [github](https://github.com/yeagerai/genvm)
8. merge `build/out` and `genvm-runners.zip`

### Full

It will also require `docker` and `docker-buildx`

1. `cd $PROJECT_DIR`
2. `git submodule update --init --recursive --depth 1`
3. `./build-scripts/install/install-deps.rb --os --rust --genvm --runners`
4. `source env.sh` (not needed if you used flake)
5. `ya-build config` (for release build pass `--preload build-scripts/ci/release-conf.rb`)
6. `ninja -C build tags/all`
7. full genvm (including runners) is located at `build/out`

## Contributing

For contributing documentation see [contributing page](./doc/contributing/README.md)
