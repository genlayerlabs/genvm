# { "Depends": "py-genlayer:test" }

import _genlayer_wasi as wasi
import genlayer.py.calldata as calldata
import os

import cloudpickle


def foo():
	print('we will have an infinite loop...')


try:
	fd = wasi.gl_call(
		calldata.encode(
			{
				'Sandbox': {
					'a_extra_field': True,
					'data': cloudpickle.dumps(foo),
				}
			}
		),
	)
except Exception as e:
	print(e)
	exit(30)

print(os.fdopen(fd).read())

exit(0)
